<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Product Swiper with Variant Selection</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      body {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        min-height: 100vh;
        padding: 20px;
        color: #333;
      }

      .container {
        margin: 0 auto;
        padding: 20px;
      }

      header {
        text-align: center;
        margin-bottom: 40px;
      }

      h1 {
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 2.5rem;
      }

      .subtitle {
        color: #7f8c8d;
        font-size: 1.1rem;
        margin-bottom: 30px;
      }

      .cart-summary {
        display: flex;
        justify-content: flex-end;
        margin-bottom: 20px;
      }

      .cart-icon {
        position: relative;
        background: #3498db;
        color: white;
        padding: 12px 20px;
        border-radius: 30px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
        transition: all 0.3s ease;
      }

      .cart-icon:hover {
        background: #2980b9;
        transform: translateY(-2px);
      }

      .cart-count {
        position: absolute;
        top: -8px;
        right: -8px;
        background: #e74c3c;
        color: white;
        width: 24px;
        height: 24px;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 0.8rem;
        font-weight: bold;
      }

      /* Swiper Container */
      .swiper {
        width: 100%;
        /* height: 930px; */
        margin-bottom: 40px;
      }

      /* Product Card */
      .product-card {
        background: white;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        width: 100%;
        max-width: 320px;
        height: 450px;
        display: flex;
        flex-direction: column;
      }

      .product-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
      }

      .product-image {
        height: 200px;
        overflow: hidden;
      }

      .product-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
      }

      .product-card:hover .product-image img {
        transform: scale(1.05);
      }

      .product-info {
        padding: 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: column;
      }

      .product-title {
        font-size: 1.4rem;
        margin-bottom: 10px;
        color: #2c3e50;
      }

      .product-description {
        color: #7f8c8d;
        font-size: 0.9rem;
        margin-bottom: 15px;
        line-height: 1.5;
        flex-grow: 1;
      }

      .product-price {
        font-size: 1.5rem;
        font-weight: bold;
        color: #2ecc71;
        margin-bottom: 15px;
      }

      .product-actions {
        display: flex;
        gap: 10px;
      }

      .btn {
        padding: 12px 20px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        flex: 1;
      }

      .btn-add-to-cart {
        background: #3498db;
        color: white;
      }

      .btn-add-to-cart:hover {
        background: #2980b9;
      }

      .btn-buy-now {
        background: #2ecc71;
        color: white;
      }

      .btn-buy-now:hover {
        background: #27ae60;
      }

      /* Modal */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal {
        background: white;
        border-radius: 15px;
        width: 90%;
        max-width: 500px;
        max-height: 90vh;
        overflow-y: auto;
        padding: 30px;
        position: relative;
        transform: translateY(20px);
        transition: transform 0.3s ease;
      }

      .modal-overlay.active .modal {
        transform: translateY(0);
      }

      .modal-close {
        position: absolute;
        top: 15px;
        right: 15px;
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: #7f8c8d;
        transition: color 0.3s ease;
      }

      .modal-close:hover {
        color: #e74c3c;
      }

      .modal-title {
        font-size: 1.8rem;
        margin-bottom: 20px;
        color: #2c3e50;
      }

      .variant-section {
        margin-bottom: 25px;
      }

      .variant-title {
        font-size: 1.1rem;
        margin-bottom: 10px;
        color: #34495e;
      }

      .variant-options {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      .variant-option {
        padding: 10px 15px;
        border: 2px solid #ddd;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .variant-option:hover {
        border-color: #3498db;
        background: #f8f9fa;
      }

      .variant-option.selected {
        border-color: #3498db;
        background: #3498db;
        color: white;
      }

      .variant-price {
        font-size: 1.5rem;
        font-weight: bold;
        color: #2ecc71;
        margin: 20px 0;
      }

      .modal-actions {
        display: flex;
        gap: 15px;
      }

      .modal-actions .btn {
        flex: 1;
      }

      /* Cart Panel */
      .cart-panel {
        position: fixed;
        top: 0;
        right: -400px;
        width: 350px;
        height: 100vh;
        background: white;
        box-shadow: -5px 0 15px rgba(0, 0, 0, 0.1);
        z-index: 1001;
        transition: right 0.4s ease;
        display: flex;
        flex-direction: column;
      }

      .cart-panel.active {
        right: 0;
      }

      .cart-header {
        padding: 20px;
        border-bottom: 1px solid #eee;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .cart-title {
        font-size: 1.5rem;
        color: #2c3e50;
      }

      .cart-close {
        background: none;
        border: none;
        font-size: 1.3rem;
        cursor: pointer;
        color: #7f8c8d;
      }

      .cart-items {
        flex-grow: 1;
        overflow-y: auto;
        padding: 20px;
      }

      .cart-item {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
        padding-bottom: 20px;
        border-bottom: 1px solid #f1f1f1;
      }

      .cart-item-image {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        overflow: hidden;
      }

      .cart-item-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .cart-item-details {
        flex-grow: 1;
      }

      .cart-item-title {
        font-weight: 600;
        margin-bottom: 5px;
      }

      .cart-item-variant {
        color: #7f8c8d;
        font-size: 0.9rem;
        margin-bottom: 8px;
      }

      .cart-item-price {
        font-weight: bold;
        color: #2ecc71;
      }

      .cart-footer {
        padding: 20px;
        border-top: 1px solid #eee;
      }

      .cart-total {
        display: flex;
        justify-content: space-between;
        font-size: 1.3rem;
        font-weight: bold;
        margin-bottom: 20px;
      }

      .checkout-btn {
        width: 100%;
        padding: 15px;
        background: #2ecc71;
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        font-size: 1.1rem;
        cursor: pointer;
        transition: background 0.3s ease;
      }

      .checkout-btn:hover {
        background: #27ae60;
      }

      .empty-cart {
        text-align: center;
        padding: 40px 20px;
        color: #7f8c8d;
      }

      .notification {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: #2ecc71;
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        z-index: 1002;
        transition: transform 0.4s ease;
        font-weight: 500;
      }

      .notification.show {
        transform: translateX(-50%) translateY(0);
      }

      .swiper-button-next,
      .swiper-button-prev {
        color: #3498db;
        background: rgba(255, 255, 255, 0.8);
        width: 50px;
        height: 50px;
        border-radius: 50%;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }

      .swiper-button-next:after,
      .swiper-button-prev:after {
        font-size: 1.5rem;
      }

      @media (max-width: 768px) {
        .swiper {
          height: 450px;
        }

        .product-card {
          height: 420px;
        }

        .cart-panel {
          width: 100%;
          right: -100%;
        }

        .modal {
          width: 95%;
          padding: 20px;
        }

        .product-actions {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>Product Showcase</h1>
        <p class="subtitle">
          Swipe through products, select variants, and add to cart
        </p>
      </header>

      <div class="cart-summary">
        <div class="cart-icon" id="cartIcon">
          <i class="fas fa-shopping-cart"></i>
          <span>View Cart</span>
          <div class="cart-count" id="cartCount">0</div>
        </div>
      </div>

      <!-- Swiper Container -->
      <div class="swiper">
        <div class="swiper-wrapper" id="productSwiper">
          <!-- Product cards will be generated by JavaScript -->
        </div>

        <!-- Navigation buttons -->
        <div class="swiper-button-next"></div>
        <div class="swiper-button-prev"></div>
      </div>

      <!-- Variant Selection Modal -->
      <div class="modal-overlay" id="variantModal">
        <div class="modal">
          <button class="modal-close" id="closeModal">&times;</button>
          <h2 class="modal-title" id="modalProductTitle">Select Variant</h2>

          <div id="variantSections">
            <!-- Variant options will be added here -->
          </div>

          <div class="variant-price" id="modalPrice">$0.00</div>

          <div class="modal-actions">
            <button class="btn btn-add-to-cart" id="addToCartFromModal">
              <i class="fas fa-cart-plus"></i> Add to Cart
            </button>
            <button class="btn btn-buy-now" id="buyNowFromModal">
              <i class="fas fa-bolt"></i> Buy Now
            </button>
          </div>
        </div>
      </div>

      <!-- Cart Panel -->
      <div class="cart-panel" id="cartPanel">
        <div class="cart-header">
          <h3 class="cart-title">Your Cart</h3>
          <button class="cart-close" id="closeCart">&times;</button>
        </div>

        <div class="cart-items" id="cartItems">
          <!-- Cart items will be added here -->
          <div class="empty-cart" id="emptyCart">
            <i class="fas fa-shopping-cart fa-3x"></i>
            <p>Your cart is empty</p>
          </div>
        </div>

        <div class="cart-footer">
          <div class="cart-total">
            <span>Total:</span>
            <span id="cartTotal">$0.00</span>
          </div>
          <button class="checkout-btn">Proceed to Checkout</button>
        </div>
      </div>

      <!-- Notification -->
      <div class="notification" id="notification">Item added to cart!</div>
    </div>

    <!-- Include Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script>
      // Product data
      const products = [
        {
          id: 1,
          title: "Wireless Bluetooth Headphones",
          description:
            "Premium noise-cancelling headphones with 30hr battery life and crystal clear audio.",
          basePrice: 129.99,
          image:
            "https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Color: [
              { name: "Black", priceModifier: 0 },
              { name: "White", priceModifier: 10 },
              { name: "Blue", priceModifier: 5 },
              { name: "Red", priceModifier: 5 },
            ],
            "Connection Type": [
              { name: "Bluetooth 5.0", priceModifier: 0 },
              { name: "Bluetooth 5.2", priceModifier: 15 },
              { name: "Wired + Bluetooth", priceModifier: 20 },
            ],
          },
        },
        {
          id: 2,
          title: "Smart Fitness Watch",
          description:
            "Track your workouts, heart rate, sleep, and receive smartphone notifications.",
          basePrice: 199.99,
          image:
            "https://images.unsplash.com/photo-1523275335684-37898b6baf30?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Size: [
              { name: "Small (38mm)", priceModifier: 0 },
              { name: "Medium (42mm)", priceModifier: 10 },
              { name: "Large (46mm)", priceModifier: 20 },
            ],
            Band: [
              { name: "Silicone", priceModifier: 0 },
              { name: "Leather", priceModifier: 25 },
              { name: "Metal", priceModifier: 40 },
            ],
          },
        },
        {
          id: 3,
          title: "Professional Camera",
          description:
            "24MP DSLR camera with 18-55mm lens, perfect for photography enthusiasts.",
          basePrice: 599.99,
          image:
            "https://images.unsplash.com/photo-1516035069371-29a1b244cc32?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            "Lens Kit": [
              { name: "18-55mm", priceModifier: 0 },
              { name: "18-135mm", priceModifier: 150 },
              { name: "24-70mm", priceModifier: 300 },
            ],
            Color: [
              { name: "Black", priceModifier: 0 },
              { name: "Silver", priceModifier: 50 },
            ],
          },
        },
        {
          id: 4,
          title: "Gaming Laptop",
          description:
            "High-performance laptop with RTX 4070, 32GB RAM, and 1TB SSD for gaming and creative work.",
          basePrice: 1499.99,
          image:
            "https://images.unsplash.com/photo-1603302576837-37561b2e2302?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            "Graphics Card": [
              { name: "RTX 4060", priceModifier: -200 },
              { name: "RTX 4070", priceModifier: 0 },
              { name: "RTX 4080", priceModifier: 400 },
            ],
            RAM: [
              { name: "16GB", priceModifier: -100 },
              { name: "32GB", priceModifier: 0 },
              { name: "64GB", priceModifier: 300 },
            ],
          },
        },
        {
          id: 5,
          title: "Smartphone Pro",
          description:
            "Flagship smartphone with advanced camera system, 5G connectivity, and all-day battery.",
          basePrice: 999.99,
          image:
            "https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Storage: [
              { name: "128GB", priceModifier: 0 },
              { name: "256GB", priceModifier: 100 },
              { name: "512GB", priceModifier: 250 },
            ],
            Color: [
              { name: "Space Gray", priceModifier: 0 },
              { name: "Silver", priceModifier: 0 },
              { name: "Gold", priceModifier: 20 },
              { name: "Deep Purple", priceModifier: 20 },
            ],
          },
        },
        {
          id: 6,
          title: "Wireless Earbuds",
          description:
            "True wireless earbuds with noise cancellation and 24hr battery with charging case.",
          basePrice: 159.99,
          image:
            "https://images.unsplash.com/photo-1590658165737-15a047b8b5e7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Color: [
              { name: "White", priceModifier: 0 },
              { name: "Black", priceModifier: 0 },
              { name: "Blue", priceModifier: 5 },
              { name: "Green", priceModifier: 5 },
            ],
          },
        },
        {
          id: 7,
          title: "Ultra HD TV",
          description:
            "65-inch 4K Smart TV with HDR, streaming apps, and immersive sound technology.",
          basePrice: 799.99,
          image:
            "https://images.unsplash.com/photo-1593359677879-a4bb92f829d1?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Size: [
              { name: "55-inch", priceModifier: -150 },
              { name: "65-inch", priceModifier: 0 },
              { name: "75-inch", priceModifier: 400 },
            ],
            Features: [
              { name: "Basic Smart TV", priceModifier: 0 },
              { name: "Gaming Edition", priceModifier: 100 },
              { name: "Cinema Edition", priceModifier: 200 },
            ],
          },
        },
        {
          id: 8,
          title: "Coffee Maker",
          description:
            "Programmable coffee maker with grinder, thermal carafe, and strength control.",
          basePrice: 129.99,
          image:
            "https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Capacity: [
              { name: "8 Cups", priceModifier: -20 },
              { name: "12 Cups", priceModifier: 0 },
              { name: "14 Cups", priceModifier: 30 },
            ],
            Color: [
              { name: "Black", priceModifier: 0 },
              { name: "Stainless Steel", priceModifier: 30 },
              { name: "Red", priceModifier: 10 },
            ],
          },
        },
        {
          id: 9,
          title: "Running Shoes",
          description:
            "Lightweight running shoes with cushioning technology for maximum comfort.",
          basePrice: 119.99,
          image:
            "https://images.unsplash.com/photo-1542291026-7eec264c27ff?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Size: [
              { name: "US 7", priceModifier: 0 },
              { name: "US 8", priceModifier: 0 },
              { name: "US 9", priceModifier: 0 },
              { name: "US 10", priceModifier: 0 },
              { name: "US 11", priceModifier: 0 },
            ],
            Color: [
              { name: "Black/White", priceModifier: 0 },
              { name: "Blue/Orange", priceModifier: 0 },
              { name: "Red/Black", priceModifier: 5 },
            ],
          },
        },
        {
          id: 10,
          title: "Backpack",
          description:
            "Water-resistant backpack with laptop compartment, multiple pockets, and ergonomic design.",
          basePrice: 79.99,
          image:
            "https://images.unsplash.com/photo-1553062407-98eeb64c6a62?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
          variants: {
            Size: [
              { name: "20L", priceModifier: -10 },
              { name: "30L", priceModifier: 0 },
              { name: "40L", priceModifier: 15 },
            ],
            Color: [
              { name: "Black", priceModifier: 0 },
              { name: "Gray", priceModifier: 0 },
              { name: "Blue", priceModifier: 0 },
              { name: "Green", priceModifier: 5 },
            ],
          },
        },
      ];

      // Cart state
      let cart = [];
      let currentProduct = null;
      let selectedVariants = {};

      // DOM elements
      const productSwiperEl = document.getElementById("productSwiper");
      const cartIcon = document.getElementById("cartIcon");
      const cartCount = document.getElementById("cartCount");
      const cartPanel = document.getElementById("cartPanel");
      const closeCart = document.getElementById("closeCart");
      const cartItems = document.getElementById("cartItems");
      const cartTotal = document.getElementById("cartTotal");
      const emptyCart = document.getElementById("emptyCart");
      const variantModal = document.getElementById("variantModal");
      const closeModal = document.getElementById("closeModal");
      const modalProductTitle = document.getElementById("modalProductTitle");
      const variantSections = document.getElementById("variantSections");
      const modalPrice = document.getElementById("modalPrice");
      const addToCartFromModal = document.getElementById("addToCartFromModal");
      const buyNowFromModal = document.getElementById("buyNowFromModal");
      const notification = document.getElementById("notification");

      // Initialize Swiper
      let swiper;

      // Initialize the application
      function init() {
        renderProductCards();
        initSwiper();
        setupEventListeners();
        updateCartDisplay();
      }

      // Render product cards
      function renderProductCards() {
        products.forEach((product) => {
          const slide = document.createElement("div");
          slide.className = "swiper-slide";

          const card = document.createElement("div");
          card.className = "product-card";
          card.dataset.id = product.id;

          card.innerHTML = `
      <div class="product-image swiper-slide">
        <img src="${product.image}" alt="${product.title}">
      </div>
      <div class="product-info">
        <h3 class="product-title">${product.title}</h3>
        <p class="product-description">${product.description}</p>
        <div class="product-price">$${product.basePrice.toFixed(2)}</div>
        <div class="product-actions">
          <button class="btn btn-add-to-cart" data-id="${product.id}">
            <i class="fas fa-cart-plus"></i> Add to Cart
          </button>
          <button class="btn btn-buy-now" data-id="${product.id}">
            <i class="fas fa-bolt"></i> Buy Now
          </button>
        </div>
      </div>
    `;

          slide.appendChild(card);
          productSwiperEl.appendChild(slide);
        });
      }

      // Initialize Swiper
      function initSwiper() {
        swiper = new Swiper(".swiper", {
          // Enable grid mode
          grid: {
            rows: 2,
            fill: "row",
          },
          slidesPerView: 1,
          spaceBetween: 20,
          loop: true,
          navigation: {
            nextEl: ".swiper-button-next",
            prevEl: ".swiper-button-prev",
          },
          // Optional: Add pagination
          pagination: {
            el: ".swiper-pagination",
            clickable: true,
          },
          // Responsive breakpoints
          breakpoints: {
            640: {
              slidesPerView: 2,
              spaceBetween: 20,
              grid: {
                rows: 2,
                fill: "row",
              },
            },
            768: {
              slidesPerView: 3,
              spaceBetween: 20,
              grid: {
                rows: 2,
                fill: "row",
              },
            },
            1024: {
              slidesPerView: 4,
              spaceBetween: 20,
              grid: {
                rows: 2,
                fill: "row",
              },
            },
          },
        });
      }

      // Setup event listeners
      function setupEventListeners() {
        // Cart icon click
        cartIcon.addEventListener("click", () => {
          cartPanel.classList.add("active");
        });

        // Close cart panel
        closeCart.addEventListener("click", () => {
          cartPanel.classList.remove("active");
        });

        // Close modal
        closeModal.addEventListener("click", () => {
          variantModal.classList.remove("active");
        });

        // Close modal when clicking outside
        variantModal.addEventListener("click", (e) => {
          if (e.target === variantModal) {
            variantModal.classList.remove("active");
          }
        });

        // Add to cart from modal
        addToCartFromModal.addEventListener("click", addToCart);

        // Buy now from modal
        buyNowFromModal.addEventListener("click", () => {
          addToCart();
          showNotification("Item purchased successfully!");
          variantModal.classList.remove("active");
        });

        // Delegate events for product cards (since they're dynamically created)
        document.addEventListener("click", (e) => {
          // Add to cart button
          if (e.target.closest(".btn-add-to-cart")) {
            const productId = parseInt(
              e.target.closest(".btn-add-to-cart").dataset.id
            );
            openVariantModal(productId);
          }

          // Buy now button
          if (e.target.closest(".btn-buy-now")) {
            const productId = parseInt(
              e.target.closest(".btn-buy-now").dataset.id
            );
            openVariantModal(productId, true);
          }
        });
      }

      // Open variant modal for a product
      function openVariantModal(productId, isBuyNow = false) {
        currentProduct = products.find((p) => p.id === productId);

        if (!currentProduct) return;

        // Reset selected variants
        selectedVariants = {};

        // Set modal title
        modalProductTitle.textContent = currentProduct.title;

        // Clear variant sections
        variantSections.innerHTML = "";

        // Create variant sections
        Object.keys(currentProduct.variants).forEach((variantType) => {
          const section = document.createElement("div");
          section.className = "variant-section";

          const title = document.createElement("h4");
          title.className = "variant-title";
          title.textContent = variantType;
          section.appendChild(title);

          const optionsContainer = document.createElement("div");
          optionsContainer.className = "variant-options";

          currentProduct.variants[variantType].forEach((option, index) => {
            const optionEl = document.createElement("div");
            optionEl.className = "variant-option";
            optionEl.textContent = option.name;
            optionEl.dataset.variantType = variantType;
            optionEl.dataset.optionIndex = index;

            // Select first option by default
            if (index === 0) {
              optionEl.classList.add("selected");
              selectedVariants[variantType] = option;
            }

            optionEl.addEventListener("click", () => {
              // Remove selected class from all options in this variant type
              optionsContainer
                .querySelectorAll(".variant-option")
                .forEach((opt) => {
                  opt.classList.remove("selected");
                });

              // Add selected class to clicked option
              optionEl.classList.add("selected");

              // Update selected variant
              selectedVariants[variantType] = option;

              // Update price
              updateModalPrice();
            });

            optionsContainer.appendChild(optionEl);
          });

          section.appendChild(optionsContainer);
          variantSections.appendChild(section);
        });

        // Update price
        updateModalPrice();

        // Store if this is for buy now
        addToCartFromModal.dataset.buyNow = isBuyNow;

        // Show modal
        variantModal.classList.add("active");
      }

      // Update modal price based on selected variants
      function updateModalPrice() {
        if (!currentProduct) return;

        let totalPrice = currentProduct.basePrice;

        // Add price modifiers from selected variants
        Object.values(selectedVariants).forEach((variant) => {
          totalPrice += variant.priceModifier;
        });

        modalPrice.textContent = `$${totalPrice.toFixed(2)}`;
      }

      // Add to cart function
      function addToCart() {
        if (!currentProduct) return;

        // Calculate final price
        let finalPrice = currentProduct.basePrice;
        let variantDescription = "";

        Object.keys(selectedVariants).forEach((variantType) => {
          const variant = selectedVariants[variantType];
          finalPrice += variant.priceModifier;
          variantDescription += `${variantType}: ${variant.name}, `;
        });

        // Remove trailing comma and space
        variantDescription = variantDescription.slice(0, -2);

        // Create cart item
        const cartItem = {
          id: currentProduct.id,
          title: currentProduct.title,
          image: currentProduct.image,
          variant: variantDescription,
          price: finalPrice,
          quantity: 1,
        };

        // Check if item already exists in cart
        const existingItemIndex = cart.findIndex(
          (item) => item.id === cartItem.id && item.variant === cartItem.variant
        );

        if (existingItemIndex >= 0) {
          // Update quantity if item exists
          cart[existingItemIndex].quantity += 1;
        } else {
          // Add new item to cart
          cart.push(cartItem);
        }

        // Update cart display
        updateCartDisplay();

        // Show notification
        showNotification("Item added to cart!");

        // Check if this was a buy now action
        const isBuyNow = addToCartFromModal.dataset.buyNow === "true";

        if (!isBuyNow) {
          // Close modal after adding to cart
          setTimeout(() => {
            variantModal.classList.remove("active");
          }, 300);
        }
      }

      // Update cart display
      function updateCartDisplay() {
        // Update cart count
        const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
        cartCount.textContent = totalItems;

        // Update cart items
        cartItems.innerHTML = "";

        if (cart.length === 0) {
          emptyCart.style.display = "block";
          cartItems.appendChild(emptyCart);
        } else {
          emptyCart.style.display = "none";

          let totalPrice = 0;

          cart.forEach((item, index) => {
            totalPrice += item.price * item.quantity;

            const cartItemEl = document.createElement("div");
            cartItemEl.className = "cart-item";
            cartItemEl.innerHTML = `
                        <div class="cart-item-image">
                            <img src="${item.image}" alt="${item.title}">
                        </div>
                        <div class="cart-item-details">
                            <div class="cart-item-title">${item.title}</div>
                            <div class="cart-item-variant">${item.variant}</div>
                            <div class="cart-item-price">$${(
                              item.price * item.quantity
                            ).toFixed(2)}</div>
                            <div style="margin-top: 8px; display: flex; gap: 10px; align-items: center;">
                                <button class="quantity-btn" data-index="${index}" data-action="decrease" style="width: 30px; height: 30px; border-radius: 50%; background: #f1f1f1; border: none; cursor: pointer;">-</button>
                                <span>${item.quantity}</span>
                                <button class="quantity-btn" data-index="${index}" data-action="increase" style="width: 30px; height: 30px; border-radius: 50%; background: #f1f1f1; border: none; cursor: pointer;">+</button>
                                <button class="remove-btn" data-index="${index}" style="margin-left: auto; background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                    `;

            cartItems.appendChild(cartItemEl);
          });

          // Update total price
          cartTotal.textContent = `$${totalPrice.toFixed(2)}`;

          // Add event listeners to quantity buttons
          document.querySelectorAll(".quantity-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const index = parseInt(e.target.dataset.index);
              const action = e.target.dataset.action;

              if (action === "increase") {
                cart[index].quantity += 1;
              } else if (action === "decrease") {
                if (cart[index].quantity > 1) {
                  cart[index].quantity -= 1;
                } else {
                  cart.splice(index, 1);
                }
              }

              updateCartDisplay();
            });
          });

          // Add event listeners to remove buttons
          document.querySelectorAll(".remove-btn").forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const index = parseInt(e.target.dataset.index);
              cart.splice(index, 1);
              updateCartDisplay();
              showNotification("Item removed from cart!");
            });
          });
        }
      }

      // Show notification
      function showNotification(message) {
        notification.textContent = message;
        notification.classList.add("show");

        setTimeout(() => {
          notification.classList.remove("show");
        }, 3000);
      }

      // Initialize the app when DOM is loaded
      document.addEventListener("DOMContentLoaded", init);
    </script>
  </body>
</html>
